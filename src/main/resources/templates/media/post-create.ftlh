<#import "../layout.ftlh" as main>
<#import "/spring.ftl" as spring>

<@main.layout>
    <link rel="stylesheet" href="/static/css/post-create.css">

    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10 col-xl-8">
                <div class="post-create-card">
                    <div class="post-header">
                        <div class="icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <h2>–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞</h2>
                        <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞</p>
                    </div>

                    <form action="/posts/create" method="post" enctype="multipart/form-data" id="postForm">
                        <@main.csrf/>
                        <@spring.formHiddenInput "post.user.id"/>

                        <div class="form-grid">
                            <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ -->
                            <div class="form-group">
                                <label for="title" class="form-label">
                                    <i class="fas fa-heading me-2 text-primary"></i>
                                    –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
                                </label>
                                <@spring.formInput
                                "post.title"
                                'type="text" id="title" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞" maxlength="500"'
                                />
                                <@spring.showErrors "<br>" "error text-danger"/>
                            </div>

                            <!-- –¢–∏–ø –ø–æ—Å—Ç–∞ -->
                            <div class="form-group">
                                <label for="type.id" class="form-label">
                                    <i class="fas fa-tags me-2 text-primary"></i>
                                    –¢–∏–ø –ø–æ—Å—Ç–∞
                                </label>
                                <select name="type.id" id="typeId" class="form-control" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ—Å—Ç–∞</option>
                                    <#list postTypes as postType>
                                        <option value="${postType.id}"
                                                <#if post.type?? && post.type.id == postType.id>selected</#if>>
                                            ${postType.name}
                                        </option>
                                    </#list>
                                </select>
                                <@spring.showErrors "<br>" "error text-danger"/>
                            </div>
                        </div>

                        <!-- URL slug -->
                        <div class="form-group">
                            <label for="slug" class="form-label">
                                <i class="fas fa-link me-2 text-primary"></i>
                                URL –∞–¥—Ä–µ—Å (slug)
                            </label>
                            <div class="input-with-prefix">
                                <span class="input-prefix">edu.gov.kg/posts/</span>
                                <@spring.formInput
                                "post.slug"
                                'type="text" id="slug" class="form-control" placeholder="url-adresa-posta" maxlength="500"'
                                />
                            </div>
                            <div class="form-text">
                                –¢–æ–ª—å–∫–æ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è.
                            </div>
                            <@spring.showErrors "<br>" "error text-danger"/>
                        </div>

                        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
                        <div class="form-group">
                            <label for="content" class="form-label">
                                <i class="fas fa-file-text me-2 text-primary"></i>
                                –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
                            </label>
                            <@spring.formTextarea
                            "post.content"
                            'id="content" class="form-control" rows="15"'
                            />
                            <div class="form-text">
                                –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
                            </div>
                            <@spring.showErrors "<br>" "error text-danger"/>
                        </div>

                        <div class="form-group">
                            <label for="attachments" class="form-label">
                                <i class="fas fa-paperclip me-2 text-primary"></i>
                                –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                            </label>
                            <input
                                    type="file"
                                    class="form-control"
                                    id="attachments"
                                    name="attachments"
                                    multiple
                                    accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar,.7z,.jpg,.jpeg,.png,.gif,.bmp,.svg,.webp,.mp3,.wav,.flac,.mp4,.avi,.mkv,.mov">
                            <div class="form-text">
                                üìé –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã: –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞—Ä—Ö–∏–≤—ã, –∞—É–¥–∏–æ, –≤–∏–¥–µ–æ<br>
                                üí° –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –≤ —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏–ª–∏ –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å –∫–∞–∫ —Ñ–∞–π–ª—ã
                            </div>
                            <div id="filePreview" class="mt-3"></div>
                        </div>

                        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-save me-2"></i>
                                –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç
                            </button>

                            <button type="button" class="btn btn-secondary btn-lg" id="saveAsDraft">
                                <i class="fas fa-file-alt me-2"></i>
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫
                            </button>

                            <button type="button" class="btn btn-outline-primary btn-lg" id="previewBtn">
                                <i class="fas fa-eye me-2"></i>
                                –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
                            </button>

                            <a href="/posts" class="btn btn-outline-danger btn-lg">
                                <i class="fas fa-times me-2"></i>
                                –û—Ç–º–µ–Ω–∞
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
    <div class="modal fade" id="previewModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="previewContent">
                        <h1 id="previewTitle" class="mb-3"></h1>
                        <div id="previewBody"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.tiny.cloud/1/z66zloybrfzhb552oyl9fmnwcuplxmajqn017ne4zn5zg457/tinymce/6/tinymce.min.js"
            referrerpolicy="origin"></script>
    <script src="/static/js/post-create.js"></script>
</@main.layout>